<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <title>angular-skeleton</title>

</head>

<body ng-app="myApp">
    <my-grouped-table key="1111"></my-grouped-table>
    <hr />
    <my-grouped-table key="1111"></my-grouped-table>
    <script src="./angular.js"></script>
    <script>
    angular.module("myApp", [])
        .factory("groupedTableService", [function() {
            return self = {
                deepCopy: function(source){
                  var dest = {};
                  angular.copy(source, dest)
                  return dest;
                },
                loadData: function(dataKey) {
                  return self.deepCopy({
                        head: ["col1", "col2", "col3"],
                        body: [{
                            groupName: "group1",
                            groupContent: [{
                                col1: "group1-row1-col1",
                                col2: "group1-row1-col2",
                                col3: "group1-row1-col3"
                            }, {
                                col1: "group1-row2-col1",
                                col2: "group1-row2-col2",
                                col3: "group1-row2-col3"
                            }]
                        }, {
                            groupName: "group2",
                            groupContent: [{
                                col1: "group2-row1-col1",
                                col2: "group2-row1-col2",
                                col3: "group2-row1-col3"
                            }, {
                                col1: "group2-row2-col1",
                                col2: "group2-row2-col2",
                                col3: "group2-row2-col3"
                            }]
                        }]
                    })
                }
            }
        }])
        .directive("myGroupedTable", [function() {
            return {
                restrict: "E",
                scope: {
                  key: '@'
                },
                templateUrl: './my-grouped-table-tpl.html',
                controller: ['$scope', 'groupedTableService', function($scope, groupedTableService) {
                    this.data = groupedTableService.loadData($scope.key)
                }],
                controllerAs: "table",
            }
        }])
    </script>
</body>

</html>
